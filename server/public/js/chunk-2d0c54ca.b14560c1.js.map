{"version":3,"sources":["webpack:///./src/views/Visualization/vdog-bs-3d.js"],"names":["initPage","_x","_x2","_x3","_x4","_initPage","apply","this","arguments","_callee","NCBIData","myChart","oldNcList","NCBIValues","ncList","header","_ref","xData","ncData","option","regeneratorRuntime","wrap","_context","prev","next","randomList","slice","readDataToMatrix","switchColumn","data","backgroundColor","backColor","tooltip","formatter","obj","value","toolbox","showTitle","feature","saveAsImage","iconStyle","normal","borderColor","textColor","shadowColor","shadowBlur","visualMap","type","min","max","inRange","color","colorRange","reverse","textStyle","grid3D","boxWidth","boxDepth","light","main","intensity","ambient","viewControl","autoRotate","distance","autoRotateAfterStill","minDistance","maxDistance","xAxis3D","name","nameTextStyle","axisLine","lineColor","axisLabel","axisPointer","lineStyle","disableColor","yAxis3D","zAxis3D","series","data2Dto3D","shading","label","show","itemStyle","opacity","emphasis","fontSize","setOption","on","params","componentType","seriesType","nc","window","open","abrupt","join","stop","data2D","re","Array","i","length","j","push","ncNumbers","res","getNCBIValues","line"],"mappings":"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","file":"js/chunk-2d0c54ca.b14560c1.js","sourcesContent":["import { getNCBIValues, randomList, switchColumn, colorRange, backColor, lineColor, textColor, disableColor } from \"./ncbi.js\"\n\nexport async function initPage(NCBIData, myChart, oldNcList, NCBIValues) {\n    let ncList = oldNcList;\n    if (!oldNcList) ncList = randomList(NCBIData, 20);\n    // let schema = [\n    //     { name: 'name', index: 0, value: 'Organism/Name' },\n    //     { name: 'Group', index: 1, value: 'Group' },\n    //     { name: 'SubGroup', index: 2, value: 'SubGroup' },\n    //     { name: 'Type', index: 3, value: 'Type' },\n    //     { name: 'RefSeq', index: 4, value: 'RefSeq' },\n    //     { name: 'INSDC', index: 5, value: 'INSDC' },\n    //     { name: 'Size', index: 6, value: 'Size (Kb)' },\n    //     { name: 'GC', index: 7, value: 'GC%' },\n    //     { name: 'Protein', index: 8, value: 'Protein' },\n    //     { name: 'rRNA', index: 9, value: 'rRNA' },\n    //     { name: 'tRNA', index: 10, value: 'tRNA' },\n    //     { name: 'oRNA', index: 11, value: 'Other RNA' },\n    //     { name: 'Gene', index: 12, value: 'Gene' },\n    //     { name: 'Pseudogene', index: 13, value: 'Pseudogene' },\n    //     { name: 'RDate', index: 14, value: 'Release Date' },\n    //     { name: 'MDate', index: 15, value: 'Modify Date' }\n    // ];\n    let header = NCBIData[0].slice(8, 14);\n    [header[0], header[3]] = [header[3], header[0]];\n    let xData = ncList;\n\n    let ncData = readDataToMatrix(NCBIData, ncList, NCBIValues);\n    switchColumn(ncData.data, 0, 3);\n\n    let option = {\n        backgroundColor: backColor,\n        tooltip: {\n            formatter: function (obj) {\n                let value = obj.value;\n                return '<div style=\"border-bottom: 1px solid rgba(255,255,255,.3); font-size: 18px;padding-bottom: 7px;margin-bottom: 7px\">'\n                    + xData[value[0]]\n                    + '</div>'\n                    + header[value[1]] + \" : \" + value[2];\n            }\n        },\n        toolbox: {\n            showTitle: false,\n            feature: {\n                saveAsImage: {}\n            },\n            iconStyle: {\n                normal: {\n                    borderColor: textColor,\n                    shadowColor: 'rgba(0, 0, 0, 0.5)',\n                    shadowBlur: 10\n                }\n            }\n        },\n        visualMap: {\n            type: 'continuous',\n            min: ncData.min,\n            max: ncData.max,\n            inRange: {\n                color: colorRange.reverse()\n            },\n            textStyle: {\n                color: textColor\n            }\n        },\n        grid3D: {\n            boxWidth: 200,\n            boxDepth: 123,\n            light: {\n                main: {\n                    intensity: 1.2\n                },\n                ambient: {\n                    intensity: 0.3\n                }\n            },\n            viewControl: {\n                autoRotate: true,\n                distance: 300,\n                autoRotateAfterStill: 10,\n                minDistance: 150,\n                maxDistance: 400,\n            }\n        },\n        xAxis3D: {\n            type: 'category',\n            data: xData,\n            name: '',\n            nameTextStyle: {\n                color: textColor\n            },\n            axisLine: {\n                color: lineColor\n            },\n            axisLabel: {\n                textStyle: {\n                    color: textColor\n                }\n            },\n            axisPointer: {\n                lineStyle: {\n                    color: disableColor\n                }\n            }\n        },\n        yAxis3D: {\n            type: 'category',\n            data: header,\n            name: '',\n            nameTextStyle: {\n                color: textColor\n            },\n            axisLine: {\n                color: lineColor\n            },\n            axisLabel: {\n                textStyle: {\n                    color: textColor\n                }\n            },\n            axisPointer: {\n                lineStyle: {\n                    color: disableColor\n                }\n            }\n        },\n        zAxis3D: {\n            type: 'value',\n            name: '',\n            nameTextStyle: {\n                color: textColor\n            },\n            axisLine: {\n                color: lineColor\n            },\n            axisLabel: {\n                textStyle: {\n                    color: textColor\n                }\n            },\n            axisPointer: {\n                lineStyle: {\n                    color: disableColor\n                }\n            }\n        },\n        series: [{\n            type: 'bar3D',\n            data: data2Dto3D(ncData.data),\n            shading: 'color',\n            label: {\n                show: false\n            },\n            itemStyle: {\n                opacity: 0.5\n            },\n            emphasis: {\n                label: {\n                    textStyle: {\n                        fontSize: 20,\n                        color: '#dd4444'\n                    }\n                },\n                itemStyle: {\n                    color: '#dd4444'\n                }\n            }\n        }]\n    }\n    myChart.setOption(option);\n    myChart.on('click', function (params) {\n        if (params.componentType === 'series') {\n            if (params.seriesType === 'bar3D') {\n                let nc = ncList[params.data.value[0]];\n                window.open(\"http://bio.njfu.edu.cn/CPTree/service/cpdata.php?type=vdog&id=\" + nc);\n            }\n        }\n    });\n    if (!oldNcList) return ncList.join(\",\");\n}\n\nfunction data2Dto3D(data2D) {\n    var re = new Array();\n    for (var i = 0; i < data2D.length; i++) {\n        for (var j = 0; j < data2D[i].length; j++) {\n            re.push([i, j, data2D[i][j]]);\n        }\n    }\n    return re;\n}\n\nfunction readDataToMatrix(NCBIData, ncNumbers, NCBIValues) {\n    let re = new Array();\n\n    re[\"data\"] = new Array();\n    re[\"max\"] = 0;\n    re[\"min\"] = 65535;\n\n    let res = NCBIValues ? NCBIValues : getNCBIValues(NCBIData, ncNumbers);\n    for (let i = 0; i < res.length; i++) {\n        let line = res[i].slice();\n        re[\"data\"].push(line.slice(8, 14));\n        for (let j = 0; j <= re[\"data\"][i].length; j++) {\n            if (re[\"data\"][i][j] > re[\"max\"]) re[\"max\"] = re[\"data\"][i][j];\n            if (re[\"data\"][i][j] < re[\"min\"]) re[\"min\"] = re[\"data\"][i][j];\n        }\n    }\n    return re;\n}"],"sourceRoot":""}